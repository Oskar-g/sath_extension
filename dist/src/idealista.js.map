{"version":3,"file":"idealista.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,IAAI;AAC3C,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,G","sources":["webpack://sath_extension/./src/idealista/main.js"],"sourcesContent":["(function () {\r\n    'use strict'\r\n\r\n    const sathExtension = `\r\n        <div id=\"sathExtension\">\r\n            <ul>\r\n            <li><button id=\"visitadoBtn\"> üëÅ‚Äçüó® Visitado üëÅ‚Äçüó® </button></li>\r\n            <li><button id=\"likeBtn\"> ‚ù§ A√±adir favoritos.</button></li>\r\n            <li><button id=\"favoritoBtn\">‚≠ê Piso Favorito ‚≠ê </button></li>\r\n            <li><button id=\"saveListBtn\">üìñ Guardar lista</button></li>\r\n            <li><button id=\"showAllBtn\">üëÅ‚Äçüó® Ver todos</button></li>\r\n            <li><button id=\"hideFavsBtn\">üôà Ocultar favoritos</button></li>\r\n            </ul>    \r\n        </div>\r\n        `\r\n\r\n    setInterval(() => {\r\n        if (!isInmueble()) {\r\n            const savedIds = getSavedIds()\r\n\r\n            const inmuebles = Array.from(document.querySelectorAll('section.items-container.items-list article'))\r\n            inmuebles.forEach(e => e.style.display = '')\r\n\r\n            if (!isHideFavs()) {\r\n                inmuebles\r\n                    .filter(e => savedIds.includes(e.dataset['adid']))\r\n                    .forEach(e => e.style.display = 'none')\r\n            }\r\n        }\r\n\r\n\r\n    }, 1000)\r\n\r\n    function init() {\r\n        if (!isListado() && !isInmueble()) { return }\r\n\r\n        let extension = document.createElement('div')\r\n        document.body.appendChild(extension)\r\n        extension.innerHTML = sathExtension\r\n\r\n        addBtnListeners()\r\n        renderAll()\r\n        setVisited()\r\n    }\r\n\r\n    function addBtnListeners() {\r\n        const buttonActions = {\r\n            \"likeBtn\": likeAction,\r\n            \"favoritoBtn\": favoritoAction,\r\n            \"saveListBtn\": saveListAction,\r\n            \"showAllBtn\": showAllAction,\r\n            \"hideFavsBtn\": hideFavsAction,\r\n        }\r\n\r\n        Object.keys(buttonActions).forEach(key => {\r\n            document.querySelector(`#${key}`).onclick = buttonActions[key]\r\n        })\r\n\r\n    }\r\n\r\n    // -------------------------------------------------------------------------------------\r\n    // RENDERS\r\n    // -------------------------------------------------------------------------------------\r\n\r\n    function renderAll() {\r\n        renderInmueble()\r\n        renderListado()\r\n    }\r\n\r\n    function renderInmueble() {\r\n        renderFavoritoBtn()\r\n        renderLikeBtn()\r\n        renderVisitadoBtn()\r\n        renderSaveListBtn()\r\n    }\r\n\r\n    function renderListado() {\r\n        renderShowAllBtn()\r\n        renderHideFavsBtn()\r\n    }\r\n\r\n    function renderVisitadoBtn() {\r\n        document.querySelector('#visitadoBtn')\r\n            .style.display = isInmueble() && getVisited().includes(window.location.href) ? '' : 'none'\r\n    }\r\n    function renderFavoritoBtn() {\r\n        document.querySelector('#favoritoBtn')\r\n            .style.display = isInmueble() && isLiked() ? '' : 'none'\r\n    }\r\n\r\n    function renderLikeBtn() {\r\n        document.querySelector('#likeBtn')\r\n            .style.display = isInmueble() && !isLiked() ? '' : 'none'\r\n    }\r\n\r\n    function renderSaveListBtn() {\r\n        document.querySelector('#saveListBtn')\r\n            .style.display = isInmueble() ? '' : 'none'\r\n    }\r\n\r\n    function renderShowAllBtn() {\r\n        document.querySelector('#showAllBtn')\r\n            .style.display = isListado() && !isHideFavs() ? '' : 'none'\r\n    }\r\n\r\n    function renderHideFavsBtn() {\r\n        document.querySelector('#hideFavsBtn')\r\n            .style.display = isListado() && isHideFavs() ? '' : 'none'\r\n    }\r\n\r\n    // -------------------------------------------------------------------------------------\r\n    // ACTIONS\r\n    // -------------------------------------------------------------------------------------\r\n\r\n    const likeAction = function () {\r\n        localStorage.saved = [\r\n            ...new Set([\r\n                ...getSaved(),\r\n                window.location.href\r\n            ])\r\n        ].join(',')\r\n        renderAll()\r\n\r\n    }\r\n\r\n    const favoritoAction = function () {\r\n        const current = new Set(getSaved())\r\n        current.delete(window.location.href)\r\n        localStorage.saved = [\r\n            ...current\r\n        ].join(',')\r\n        renderAll()\r\n    }\r\n\r\n\r\n    const saveListAction = function () {\r\n        localStorage.saved = [\r\n            ...new Set([\r\n                ...getSaved(),\r\n                ...prompt(\"agregar lista de enlaces separados por comas\").split(',')\r\n            ])\r\n        ].join(',')\r\n        renderAll()\r\n    }\r\n\r\n    function hideFavsAction() {\r\n        setHideFavs('false')\r\n    }\r\n\r\n    function showAllAction() {\r\n        setHideFavs('true')\r\n    }\r\n\r\n    // -------------------------------------------------------------------------------------\r\n    // CHECKERS\r\n    // -------------------------------------------------------------------------------------\r\n\r\n    function isLiked() {\r\n        return isInmueble() && getSaved().includes(window.location.href)\r\n    }\r\n\r\n    function isListado() {\r\n        return window.location.href.includes('https://www.idealista.com/venta-viviendas')\r\n    }\r\n    function isInmueble() {\r\n        return window.location.href.includes('https://www.idealista.com/inmueble')\r\n    }\r\n\r\n    function setHideFavs(show) {\r\n        localStorage.hideFavs = show\r\n        renderAll()\r\n    }\r\n\r\n    function isHideFavs() {\r\n        return (localStorage.hideFavs ??= \"false\") === 'true'\r\n    }\r\n\r\n    function getSaved() {\r\n        return localStorage.saved?.split(',') || []\r\n    }\r\n\r\n    function setVisited() {\r\n        if (!isInmueble()) return\r\n\r\n        localStorage.visited = [\r\n            ...new Set([\r\n                ...getVisited(),\r\n                window.location.href\r\n            ])\r\n        ].join(',')\r\n\r\n    }\r\n\r\n    function getVisited() {\r\n        return localStorage.visited?.split(',') || []\r\n    }\r\n\r\n    function getSavedIds() {\r\n        return getSaved().map(e => e.split('/')[4])\r\n    }\r\n\r\n\r\n    init()\r\n})()"],"names":[],"sourceRoot":""}